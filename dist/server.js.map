{"version":3,"sources":["../src/server.js"],"names":["globalAgent","maxSockets","Infinity","start","log","instance","on","createServer","abort","server","process","shutdown","removeListener","close","exit"],"mappings":";;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;AAEA;;;;;;AAEA,eAAKA,WAAL,CAAiBC,UAAjB,GAA8BC,QAA9B;AACA,sBAAOC,KAAP;;AAEA,SAASA,KAAT,GAAiB;AAChB,kBAAOC,GAAP,CAAW,MAAX,EAAmB,kBAAnB;;AAEA,KAAIC,WAAW,oBAAf;;AAEAA,UAASC,EAAT,CAAY,OAAZ,EAAqBC,YAArB;AACAF,UAASC,EAAT,CAAY,MAAZ,EAAoBE,KAApB;;AAEA,UAASD,YAAT,GAAwB;AACvB,MAAIE,SAAS,mBAAIJ,QAAJ,CAAb;AACAK,UAAQJ,EAAR,CAAW,SAAX,EAAsBK,QAAtB;AACAN,WACCO,cADD,CACgB,MADhB,EACwBJ,KADxB,EAECF,EAFD,CAEI,MAFJ,EAEYK,QAFZ;;AAIA,WAASA,QAAT,GAAoB;AACnB,oBAAOP,GAAP,CAAW,MAAX,EAAmB,uBAAnB;AACAK,UAAOI,KAAP,CAAa,YAAW;AACvB,qBAAOT,GAAP,CAAW,MAAX,EAAmB,kBAAnB;AACAM,YAAQI,IAAR;AACA,IAHD;AAIA;AACD;;AAED,UAASN,KAAT,GAAiB;AAChB,mBAAOJ,GAAP,CAAW,MAAX,EAAmB,eAAnB;AACAM,UAAQI,IAAR;AACA;AACD","file":"server.js","sourcesContent":["import http from 'http';\nimport throng from 'throng';\n\nimport App from './app';\nimport Web from './web';\n\nimport logger from './modules/logger';\n\nhttp.globalAgent.maxSockets = Infinity;\nthrong(start);\n\nfunction start() {\n\tlogger.log('info', 'Starting server.');\n\n\tlet instance = App();\n\n\tinstance.on('ready', createServer);\n\tinstance.on('lost', abort);\n\n\tfunction createServer() {\n\t\tlet server = Web(instance);\n\t\tprocess.on('SIGTERM', shutdown);\n\t\tinstance\n\t\t.removeListener('lost', abort)\n\t\t.on('lost', shutdown);\n\n\t\tfunction shutdown() {\n\t\t\tlogger.log('info', 'Server shutting down.');\n\t\t\tserver.close(function() {\n\t\t\t\tlogger.log('info', 'Server shutdown.');\n\t\t\t\tprocess.exit();\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction abort() {\n\t\tlogger.log('info', 'Server abort.');\n\t\tprocess.exit();\n\t}\n}"]}